:: Tree [nobr]
<<set $HSM = HSM()>> <span id="resultX">
@@.orange;Which facility or equipment do you wish to upgrade this week?@@
	<<if $SFUnit.Firebase < 1 || $SFUnit.Firebase < 2 || $SFUnit.Firebase < 4>><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More firebase upgrades are required to unlock further options.<</if>>
	<<if $SFUnit.Firebase < 5 || $SFUnit.Firebase < _FU>>
		@@.green;<<link "Firebase">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Firebase++, $cash -= Math.ceil(100000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Firebase/100)))>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(100000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Firebase/100))))>>@@ //
	<</if>>
	<<if $SFUnit.Armoury < 5 || $SFUnit.Armoury < _AU>>
		@@.green;<<link "SF.Armoury">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Armoury++, $cash -= Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Armoury/100)))>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Armoury/100))))>>@@ //
	<</if>>
	<<if $SFUnit.Drugs < 5 || $SFUnit.Drugs < _DrugsU>>
		@@.green;<<link "Drug Lab">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Drugs++, $cash -= Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drugs/100)))>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drugs/100))))>>@@ //
	<</if>>
	<<if $SFUnit.Firebase >= 2 && ($SFUnit.Drones < 5  || $SFUnit.Drones < _DU)>>
		@@.green;<<link "Drone bay">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Drones++, $cash -= Math.ceil(45000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drones/100))*$HSM)>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(45000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drones/100))*$HSM))>>@@ //
	<</if>>

	<<if $SFUnit.Firebase >= 1 && (_G < 5 ||_G < _GU)>>
	@@.green;<<link "Garage">> <<replace "#resultX">> <span id="resultY">
		"Which unit do you wish to upgrade or 'borrow'?"
		@@.green;[[Go back|Firebase]]@@
		/*@@.green;<<link "Go back""Firebase">> <</link>>@@*/
			<<if ($SFUnit.Vehicles < 5|| $SFUnit.Vehicles < _VU)>>
				@@.green;<<link "Vehicle fleet">> <<replace "#resultY">>
					<<set $SF.U = 1, $SFUnit.Vehicles++, $cash -= Math.ceil(60000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Vehicles/100)))>> <<goto "Firebase">>
				<</replace>> <</link>>@@// @@.yellowgreen;<<print cashFormat(Math.ceil(60000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Vehicles/100))))>>@@ //
			<</if>>
			<<if $SFUnit.HBT < _HBTU>>
					@@.green;<<link "Heavy battle tank">> <<replace "#resultY">>
					<<set $SF.U = 1, $SFUnit.HBT++, $cash -= Math.ceil(150000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.HBT/100)))>> <<goto "Firebase">>
				<</replace>> <</link>>@@// @@.yellowgreen;<<print cashFormat(Math.ceil(150000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.HBT/100))))>>@@ //
			<</if>>
	</span> <</replace>> <</link>>@@ <</if>>

	<<if $SFUnit.Firebase >= 4 && (_H < 5 || _H < _HU)>>
	@@.green;<<link "Hangar">> <<replace "#resultX">> <span id="resultY">
		"Which unit do you wish to upgrade or 'borrow'?"
		@@.green;<<link "Go back""Firebase">> <</link>>@@
		<<if $SFUnit.AirForce < 5 || $SFUnit.AirForce < _AFU>>
			@@.green;<<link "Aircraft fleet">> <<replace "#resultY">>
				<<set $SF.U = 1, $SFUnit.AirForce++, $cash -= Math.ceil(70000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.AirForce/100)))>> <<goto "Firebase">>
			<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(70000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.AirForce/100))))>>@@ //
		<</if>>
		<<if $SFUnit.SpacePlane < _SPU>>
			@@.green;<<link "Space plane">> <<replace "#resultY">>
				<<set $SF.U = 1, _SF.SpacePlane++, $cash -= Math.ceil(250000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.SpacePlane/100))*$HSM)>> <<goto "Firebase">>
			<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(250000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.SpacePlane/100))*$HSM))>>@@ //
		<</if>>
		<<if $SFUnit.GunS < _GunSU>>
			@@.green;<<link "Gunship">> <<replace "#resultY">>
				<<set $SF.U = 1, $SFUnit.GunS++, $cash -= Math.ceil(350000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.GunS/100))*$HSM)>> <<goto "Firebase">>
			<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(350000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.GunS/100))*$HSM))>>@@ //
		<</if>>
	</span> <</replace>> <</link>>@@ <</if>>
		
	<<if $SFUnit.Armoury < 5 || $SFUnit.Armoury < _AU>>
		@@.green;<<link "Armoury">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Armoury++, $cash -= Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Armoury/100)))>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Armoury/100))))>>@@ //
	<</if>>
	<<if $SFUnit.Drugs < 5 || $SFUnit.Drugs < _DrugsU>>
		@@.green;<<link "Drug Lab">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Drugs++, $cash -= Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drugs/100)))>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(40000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drugs/100))))>>@@ //
	<</if>>
	<<if $SFUnit.Firebase >= 2 && ($SFUnit.Drones < 5  || $SFUnit.Drones < _DU)>>
		@@.green;<<link "Drone bay">> <<replace "#resultX">>
			<<set $SF.U = 1, $SFUnit.Drones++, $cash -= Math.ceil(45000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drones/100))*$HSM)>> <<goto "Firebase">>
		<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(45000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Drones/100))*$HSM))>>@@ //
	<</if>>

	<<if (_LB < _LBU)>>
	@@.green;<<link "Launch Bay">> <<replace "#resultX">> <span id="resultY">
		"Which unit do you wish to upgrade or 'borrow'?"
		@@.green;<<link "Go back""Firebase">> <</link>>@@
			<<if $SFUnit.Satellite < _SatU>>
				@@.green;<<link "Satellite">> <<replace "#resultY">>
					<<set $SF.U = 1, $SFUnit.Satellite++, $cash -= Math.ceil(525000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Satellite/100))*$HSM)>> <<goto "Firebase">>
				<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(525000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Satellite/100))*$HSM))>>@@ //
			<</if>>
			<<if $SFUnit.GiantRobot < _GRU && _Land>>
				@@.green;<<link "Giant robot">> <<replace "#resultY">>
					<<set $SF.U = 1, $SFUnit.GiantRobot++, $cash -= Math.ceil(550000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.GiantRobot/100))*$HSM)>> <<goto "Firebase">>
				<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(550000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.GiantRobot/100))*$HSM))>>@@ //
			<</if>>
			<<if $SFUnit.MissileSilo < _MSU && _Land>>
					@@.green;<<link "Missile silo">> <<replace "#resultY">>
						<<set $SF.U = 1, $SFUnit.MissileSilo++, $cash -= Math.ceil(565000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.MissileSilo/100))*$HSM)>> <<goto "Firebase">>
					<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(565000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.MissileSilo/100))*$HSM))>>@@ //
			<</if>>
	</span> <</replace>> <</link>>@@ <</if>>

	<<if _NY < _NYU && !_Land>>
	@@.green;<<link "Naval Yard">> <<replace "#resultX">> <span id="resultY">
			"Which unit do you wish to upgrade or 'borrow'?"
				@@.green;<<link "Go back""Firebase">> <</link>>@@
				<<if $SFUnit.AircraftCarrier < _ACU>>
					@@.green;<<link "Aircraft carrier">> <<replace "#resultY">>
						<<set $SF.U = 1, $SFUnit.AircraftCarrier++, $cash -= Math.ceil(650000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.AircraftCarrier/100))*$HSM)>> <<goto "Firebase">>
					<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(650000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.AircraftCarrier/100))*$HSM))>>@@ //
				<</if>>
				<<if $SFUnit.Sub < _SubU>>
					@@.green;<<link "Submarine">> <<replace "#resultY">>
						<<set $SF.U = 1, $SFUnit.Sub++, $cash -= Math.ceil(700000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Sub/100))*$HSM)>> <<goto "Firebase">>
					<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(700000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.Sub/100))*$HSM))>>@@ //
				<</if>>
				<<if $SFUnit.HAT < _HATU>>
					@@.green;<<link "Heavy amphibious transport">> <<replace "#resultY">>
						<<set $SF.U = 1, $SFUnit.HAT++, $cash -= Math.ceil(665000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.HAT/100)))>> <<goto "Firebase">>
					<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(665000*_Env*(1.15+($SF.Units/10))*(1.15+($SFUnit.HAT/100))))>>@@ //
				<</if>>
	</span> <</replace>> <</link>>@@ <</if>>
</span>
/* @@.green;<<link "Support Facility">> <<replace "#resultX">>
<<set $SF.U = 1, $cash -= Math.ceil( (($C*(1.15+(($SFA0/1000))*($U+.15))*_Env )>>
<<set $SFIDs = [], $SupportFacilityDecoration = "standard", $SupportFacilityNameCount = "The Support Facility", $SupportFacilityEfficiency = 0>>
<<set $SupportFacility = 5, $SupportFacilitySlaves = 0, $LieutenantColonel = 0>>
<<set $FacilitySupportSpeedUpgrades = 0, $FacilitySupportTrainingUpgrade = 0>>
<</replace>> <</link>>@@ // @@.yellowgreen;<<print cashFormat(Math.ceil(Math.ceil($C*(1.15+(($SFA0/1000)*($U+.15)*_Env)))>>@@ //*/