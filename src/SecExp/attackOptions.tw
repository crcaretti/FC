:: attackOptions [nobr]



<strong>Attack Imminent</strong>
<hr>
The ominous message dominates the screens of your office, <<print $assistantName>> quickly gathers all information available to prepare your arcology for battle.
<<if $attackType == "raiders">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		A disorganized horde of raiders is coming to your city. To such jackals your arcology surely looks like an appetizing morsel.
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the disorganized horde of raiders riding their ragtag vehicles. To such jackals your arcology surely looks like an appetizing morsel.
	<<else>>
		Some of your citizens saw the disorganized horde of raiders coming towards the city and quickly reported it. To such jackals your arcology surely looks like an appetizing morsel.
	<</if>>
	<br>
	Raiders:
	<br>&nbsp;- high attack
	<br>&nbsp;- low defense
	<br>&nbsp;- low toughness
	<br>&nbsp;- low morale
<<elseif $attackType == "free city">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		A menacing column of consumed mercenaries and slavers is coming to your city. Another free city is ready to use their best tools to bring down a dangerous competitor.
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the menacing column of consumed mercenaries and slavers. Another free city is ready to use their best tools to bring down a dangerous competitor.
	<<else>>
		Some of your citizens saw the menacing column of consumed mercenaries and slavers and rushed to your office to bring the grim news. Another free city is ready to use their best tools to bring down a dangerous competitor.
	<</if>>
	<br>
	Free City expedition:
	<br>&nbsp;- low attack
	<br>&nbsp;- high defense
	<br>&nbsp;- moderate toughness
	<br>&nbsp;- moderate morale
<<elseif $attackType == "freedom fighters">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		A dangerous looking army of guerrillas is gathering just outside the arcology. Fanatics and idealists armed with dead men's words and hope, set on erasing your fledgling empire. 
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the dangerous looking army of guerrillas is gathering just outside the arcology. Fanatics and idealists armed with dead men's words and hope, set on erasing your fledgling empire.
	<<else>>
		Some of your citizens saw the dangerous looking army of guerrillas is gathering just outside the arcology. Fanatics and idealists armed with dead men's words and hope, set on erasing your fledgling empire.
	<</if>>
	<br>
	Freedom Fighters:
	<br>&nbsp;- very high attack
	<br>&nbsp;- low defense
	<br>&nbsp;- moderate toughness
	<br>&nbsp;- very high morale
<<elseif $attackType == "old world">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		A diciplined yet dusty, scruffy old world army is approaching the confines of your arcology. There's nothing better than a good war to unite the electorate and your arcology is just the perfect target. 
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the diciplined yet dusty, scruffy old world army is approaching the confines of your arcology. There's nothing better than a good war to unite the electorate and your arcology is just the perfect target. 
	<<else>>
		Some of your citizens saw the diciplined yet dusty, scruffy old world army is approaching the confines of your arcology. There's nothing better than a good war to unite the electorate and your arcology is just the perfect target. 
	<</if>>
	<br>
	Old world expedition:
	<br>&nbsp;- high attack
	<br>&nbsp;- high defense
	<br>&nbsp;- low toughness
	<br>&nbsp;- low morale
<<elseif $attackType == "mercenary">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		Some sections of the lower levels were already no longer responding. In the end it happened, your own mercenaries took arms against their benefactor. 
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the nervous movement of mercenary units assembling in the lower levels. In the end it happened, your own mercenaries took arms against their benefactor.
	<<else>>
		Some of your citizens, terrified by the movements of mercenary units in the lower levels, were gathering near the entrance of your penthouse. In the end it happened, your own mercenaries took arms against their benefactor.
	<</if>>
<<elseif $attackType == "citizen">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		The streets were already clogged with citizens armed to the teeth, ready to oust their owner. In the end it happened, your own citizens dared took arms against their arcology owner.
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot the tumultuos mobs of armed citizens invading the streets. In the end it happened, your own citizens dared took arms against their arcology owner.
	<<else>>
		Some of your citizens, terrified by the mobs of armed rebels, were gathering near the entrance of your penthouse. In the end it happened, your own citizens dared took arms against their arcology owner.
	<</if>>
<<elseif $attackType == "slave">>
	<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
		Reports from all over the arcology are pouring in, filled with slaves assaulting, killing and butchering your citizens. In the end it happened, the slaves dared attack their betters.
		Fortunately you knew of their coming weeks in advance, the risk simulation system did its job admirably.
	<<elseif $perimeterDrones == 1>>
		Your drones easily spot inumerable instances of slaves assaulting, killing and butchering your citizens. In the end it happened, the slaves dared attack their betters.
	<<else>>
		Some of your citizens, terrified by the mass of slaves assaulting, killing and butchering their fellow citizens, were gathering near the entrance of your penthouse. In the end it happened, the slaves dared attack their betters
	<</if>>
<</if>>

	<<if $hasFoughtOnce != 1>>
		<br>
		This is your first battle as an arcology owner, <<print $assistantName>> suggests reviewing the meaning of all the data laying in front of you: [[Battle statistics and mechanics|secTutorial]]
	<</if>>
<hr>
It seems your troops and your adversary will fight
<<if $battleTerrain == "urban">>
	in <strong>the streets of <<if $terrain == "urban">>the old world city surrounding the arcology<<else>>of the free city<</if>>.</strong>
<<elseif $battleTerrain == "rural">>
	in <strong>the rural land</strong> surrounding the free city.
<<elseif $battleTerrain == "hills">>
	on <strong>the hills</strong> around the free city.
<<elseif $battleTerrain == "coast">>
	along <strong>the coast</strong> just outside the free city.
<<elseif $battleTerrain == "outskirts">>
	right against <strong>the walls of the arcology.</strong>
<<elseif $battleTerrain == "mountains">>
	in <strong>the mountains</strong> overlooking the arcology.
<<elseif $battleTerrain == "wasteland">>
	in <strong>the wastelands</strong> outside the free city territory.
<<elseif $battleTerrain == "err">>
	Error: failed to assign terrain
<<else>>
	Error: failed to read terrain, battleTerrain reads <<print $battleTerrain>>
<</if>>
<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
	Your sophisticated virtual simulations and advanced recon drones allows you to accurately predict the numbers you're about to face.Approximately <strong><<print Math.round($attackTroops * (1 + either(-1,1) * 0.1))>> men</strong> are coming.
<<elseif $perimeterDrones ==1>>
	Thanks to your drones you have a rough estimate of the numbers you're about to face. Around <strong><<print Math.round($attackTroops * (1 + either(-1,1) * random(2) * 0.1))>> men</strong> are coming
<<else>>
	Unfortunately you have no good information on what is coming your way, the confused reports of your citizens gives you only a vague number. Around <strong><<print Math.round($attackTroops * (1 + either(-1,1) * random(3) * 0.1))>> men</strong> are coming.
<</if>>
They seems to be
<<set _expectedEquip = 0>>
<<if $riskSim == 1 && $riskSimExpectedAttack == $attackType>>
	<<set _expectedEquip = $attackEquip>>
<<elseif $perimeterDrones == 1>>
	<<set _expectedEquip = $attackEquip + either(-1,1)>>
<<else>>
	<<set _expectedEquip = $attackEquip + either(-1,1) * random(2)>>
<</if>>
<<if _expectedEquip <= 0>>
	<strong>poorly armed</strong>. old rusty small arms are the norm with just a few barely working civilian vehicles. 
<<elseif _expectedEquip == 1>>
	<strong>lightly armed</strong>. mostly small arms with some repurposed civilian vehicles and a scattered few machine guns. There's no sign of heavy vehicles, artillery or aircrafts.
<<elseif _expectedEquip == 2>>
	<strong>decently armed</strong>. good quality small arms, machine guns a few mortars. There seems to be some heavy military vehicles coming as well.
<<elseif _expectedEquip == 3>>
	<strong>well armed</strong>. high quality small arms, snipers, demolitions teams, heavy duty machine guns and mortars. Heavy military vehicles are numerous and a few artillery piecies are accompaning the detachment. 
<<elseif _expectedEquip == 4>>
	<strong>extremely well armed</strong>. excellent small arms and specialized teams with heavy duty infantry support weapons. Heavy presence of armored military vehicles, artillery pieces and even some attack helicopters.
<</if>>

<br><br>

You quickly lay down a plan of action:
<br>
<<link "Let the assistant handle this attack">>
	<<if $assistantPower == 2>>
	<<elseif $assistantPower == 1>>
	<<else>>
	<</if>>
<</link>>

<br>&nbsp;&nbsp;&nbsp;&nbsp;//$assistantName will handle leaders, tactics and troop deployment to the best of her abilities. To be implemented//

<br><br>

/* leader assignment */
<span id="leader"><strong><<print $assistantName>></strong></span> will lead your troops.
	<br>&nbsp;&nbsp;&nbsp;&nbsp;
	<<link "Personally join the battle">>
		<<set $leadingTroops = "PC">>
		<<replace "#leader">><strong><<print $PC.name>></strong><</replace>>
	<</link>>
	|
	<<link "Let $assistantName lead the troops">>
		<<set $leadingTroops = "assistant">>
		<<replace "#leader">><strong><<print $assistantName>></strong><</replace>>
	<</link>>
	<<if $Bodyguard != 0 && $slavesInArmy == 1>>
	|
	<<link "Let your bodyguard lead your troops">>
		<<set $leadingTroops = "bodyguard">>
		<<replace "#leader">><strong><<print $Bodyguard.slaveName>></strong><</replace>>
	<</link>>
	<</if>>
	<<if $HeadGirl != 0 && $slavesInArmy == 1>>
	|
	<<link "Let your head girl lead your troops">>
		<<set $leadingTroops = "headGirl">>
		<<replace "#leader">><strong><<print $HeadGirl.slaveName>></strong><</replace>>
	<</link>>
	<</if>>
	<<if $militiaCreated == 1>>
	|
	<<link "Let the citizens' militia officers lead the troops">>
		<<set $leadingTroops = "citizen">>
		<<replace "#leader">><strong>The citizens' militia commander</strong><</replace>>
	<</link>>
	<</if>>
	<<if $mercenaries > 0>>
	|
	<<link "Let the mercenary officers lead the troops">>
		<<set $leadingTroops = "mercenary">>
		<<replace "#leader">><strong>The mercenary commander</strong><</replace>>
	<</link>>
	<</if>>

/* troop deployment */
<br><br>
With your current readiness level you can <<if $deployedUnits > 0>>still<</if>> send <strong><<print $deployableUnits>></strong>. Available units:

<<set _mL = $militiaUnits.length>>
<<set _sL = $slaveUnits.length>>
<<set _meL = $mercUnits.length>>
<<if $deployableUnits > 0>>
		<<if $secBots.active == 1 && $secBots.isDeployed == 0 && $secBots.troops > 0>>
			<br>
			<<secBotsDescription>>
			<br>
			<<link "Deploy the unit">>
				<<set $secBots.isDeployed = 1>>
				<<set $deployableUnits-->>
				<<set $deployedUnits++>>
				<<set $deployingBots = 1>>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<<for _i = 0; _i < _mL; _i++>>
		<<if $militiaUnits[_i].active == 1 && $militiaUnits[_i].isDeployed == 0 && $militiaUnits[_i].troops > 0>>
			<br>
			<<militiaUnitsDescription $militiaUnits[_i]>>
			<br>
			<<link "Deploy the unit">>
				<<set $militiaUnits[_i].isDeployed = 1>>
				<<set $deployableUnits-->>
				<<set $deployedUnits++>>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
	<<for _i = 0; _i < _sL; _i++>>
		<<if $slaveUnits[_i].active == 1 && $slaveUnits[_i].isDeployed == 0 && $slaveUnits[_i].troops > 0>>
			<br>
			<<slaveUnitsDescription $slaveUnits[_i]>>
			<br>
			<<link "Deploy the unit">>
				<<set $slaveUnits[_i].isDeployed = 1>>
				<<set $deployableUnits-->>
				<<set $deployedUnits++>>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
	<<for _i = 0; _i < _meL; _i++>>
		<<if $mercUnits[_i].active == 1 && $mercUnits[_i].isDeployed == 0 && $mercUnits[_i].troops > 0>>
			<br>
			<<mercUnitsDescription $mercUnits[_i]>>
			<br>
			<<link "Deploy the unit">>
				<<set $mercUnits[_i].isDeployed = 1>>
				<<set $deployableUnits-->>
				<<set $deployedUnits++>>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
<<else>>
	<br>
	Unit roster full.
<</if>>

<br>

Units about to be deployed:
<<if $deployedUnits > 0>>
		<<if $secBots.isDeployed == 1>>
			<br>
			<<secBotsDescription>>
			<br>
			<<link "Remove the unit">>
				<<set $secBots.isDeployed = 0>>
				<<set $deployableUnits++>>
				<<set $deployedUnits-->>
				<<set $deployingBots = 0>>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<<for _i = 0; _i < _mL; _i++>>
		<<if $militiaUnits[_i].isDeployed == 1>>
			<br>
			<<militiaUnitsDescription $militiaUnits[_i]>>
			<br>
			<<link "Remove the unit">>
				<<set $militiaUnits[_i].isDeployed = 0>>
				<<set $deployableUnits++>>
				<<set $deployedUnits-->>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
	<<for _i = 0; _i < _sL; _i++>>
		<<if $slaveUnits[_i].isDeployed == 1>>
			<br>
			<<slaveUnitsDescription $slaveUnits[_i]>>
			<br>
			<<link "Remove the unit">>
				<<set $slaveUnits[_i].isDeployed = 0>>
				<<set $deployableUnits++>>
				<<set $deployedUnits-->>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
	<<for _i = 0; _i < _meL; _i++>>
		<<if $mercUnits[_i].isDeployed == 1>>
			<br>
			<<mercUnitsDescription $mercUnits[_i]>>
			<br>
			<<link "Remove the unit">>
				<<set $mercUnits[_i].isDeployed = 0>>
				<<set $deployableUnits++>>
				<<set $deployedUnits-->>
				<<goto "attackOptions">>
			<</link>>
		<</if>>
	<</for>>
<</if>>
<<for _i = 0; _i < _mL; _i++>>
	<<if $militiaUnits[_i].isDeployed == 1>>
		<<set $deployingMilitia = 1>>
		<<break>>
	<</if>>
<</for>>
<<for _i = 0; _i < _sL; _i++>>
	<<if $slaveUnits[_i].isDeployed == 1>>
		<<set $deployingSlaves = 1>>
		<<break>>
	<</if>>
<</for>>
<<for _i = 0; _i < _meL; _i++>>
	<<if $mercUnits[_i].isDeployed == 1>>
		<<set $deployingMercs = 1>>
		<<break>>
	<</if>>
<</for>>

<br><br>

/* tactics */
<<if $leadingTroops != "PC">>
	For this battle you command your chosen leaders to follow <span id="tactic"><strong><<print $chosenTactic>></strong></span> tactics.
<<else>>
	For this battle you choose to follow <span id="tactic"><strong><<print $chosenTactic>></strong></span> tactics.
<</if>>
<br><br>
Defensive tactics
<br>
<<link "Bait and Bleed">>
	<<set $chosenTactic = "Bait and Bleed">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Combines bait and switch tactics with guerriglia style assaults, with the objective of slowly bleed the enemy.//
<br>
<<link "Guerrilla">>
	<<set $chosenTactic = "Guerrilla">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves using terrain knowledge and small fast attacks to hinder and weaken the enemy.//
<br>
<<link "Choke Points">>
	<<set $chosenTactic = "Choke Points">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves using terrain knowledge and strong fortifications in order to stop the enemy on its track.//
<br>
<<link "Interior Lines">>
	<<set $chosenTactic = "Interior Lines">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves exploiting a defender's shorter logistics lines and redeployment times in order to keep the enemy pressured.//
<br>
<<link "Pincer Manouver">>
	<<set $chosenTactic = "Pincer Manouver">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves letting the enemy push back the centre in order to envelop their formation.//
<br>
<<link "Defense In Depth">>
	<<set $chosenTactic = "Defense In Depth">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves letting the enemy gain terrain to gain tactical superiority by alternating between delaying actions and small counterattacks.//
<br>
Offensive Tactics
<br>
<<link "Blitzkrieg">>
	<<set $chosenTactic = "Blitzkrieg">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves breaking the front of the enemy with a fast armored force concentrated into a small area.//
<br>
<<link "Human Wave">>
	<<set $chosenTactic = "Human Wave">>
	<<replace "#tactic">><strong><<print $chosenTactic>></strong><</replace>>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Involves assaulting the enemy with large numbers of infantry to overwhelm their lines.//
<br>
<br>
<<if $deployedUnits > 0>>
	<<link "Send your orders">>
		<<set $battleResult = 4>>					/* sets $battleResult value outside accepted range to avoid evaluation problems */
		<<goto "attackHandler">>
	<</link>>
<<else>>
	You need at least a unit in your roster to proceed to battle.
<</if>>
<br>
<<link "Surrender">>
	<<set $battleResult = -1>>
	<<goto "attackHandler">>
<</link>>
<br>
/* calculates bribe cost */
<<if $week <= 30>>
	<<set $bribeCost = 5000 + $baseBribePerAttacker * $attackTroops>>
<<elseif $week <= 30>>
	<<set $bribeCost = 10000 + $baseBribePerAttacker * $attackTroops>>
<<elseif $week <= 30>>
	<<set $bribeCost = 15000 + $baseBribePerAttacker * $attackTroops>>
<<elseif $week <= 30>>
	<<set $bribeCost = 20000 + $baseBribePerAttacker * $attackTroops>>
<<elseif $week <= 30>>
	<<set $bribeCost = 25000 + $baseBribePerAttacker * $attackTroops>>
<</if>>

<<link "Attempt to bribe">>
	<<set $battleResult = 1>>
	<<goto "attackHandler">>
<</link>>
<br>&nbsp;&nbsp;&nbsp;&nbsp;//Will cost around ¤<<print Math.round($bribeCost * (1 + either(-1,1) * random(2) * 0.1))>>.//