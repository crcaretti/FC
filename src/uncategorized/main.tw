:: Main [nobr]
 
<<if $ver.contains("0.9") or $ver.contains("0.8") or $ver.contains("0.7") or $ver.contains("0.6")>>
	<<if ($ver != "0.9.7")>>
		''@@color:red;INCOMPATIBLE SAVE WARNING:@@'' your saved game was created using version $ver and you are using version 0.9.7. Please select New Game Plus from the Options menu or start a new game.
		<br><br>
	<</if>>
<<else>>
	''@@color:red;INCOMPATIBLE SAVE WARNING:@@'' your saved game was created using version $ver and you are a later version which New Game Plus cannot reconcile. Please start a new game.
	<br><br>	
<</if>>

<<if ndef $defaultRules>>
	<<display "Init Rules">>
<</if>>
<<set $currentRule to $defaultRules[0]>>

<<switch $sortSlavesBy>>
<<case "name">>
	<<if ($sortSlavesOrder is "ascending")>>
	<<set $slaves to $slaves.sort(function(a, b){if(a.slaveName < b.slaveName) return -1; if(a.slaveName > b.slaveName) return 1; return 0;})>>
	<<else>>
	<<set $slaves to $slaves.sort(function(a, b){if(a.slaveName > b.slaveName) return -1; if(a.slaveName < b.slaveName) return 1; return 0;})>>
	<</if>>
<<case "assignment">>
	<<if ($sortSlavesOrder is "ascending")>>
	<<set $slaves to $slaves.sort(function(a, b){if(a.assignment < b.assignment) return -1; if(a.assignment > b.assignment) return 1; return 0;})>>
	<<else>>
	<<set $slaves to $slaves.sort(function(a, b){if(a.assignment > b.assignment) return -1; if(a.assignment < b.assignment) return 1; return 0;})>>
	<</if>>
<<case "seniority">>
	<<if ($sortSlavesOrder is "ascending")>>
	<<set $slaves to $slaves.sort(function(a, b){return b.weekAcquired-a.weekAcquired})>>
	<<else>>
	<<set $slaves to $slaves.sort(function(a, b){return a.weekAcquired-b.weekAcquired})>>
	<</if>>
<<case "age">>
	<<if ($sortSlavesOrder is "ascending")>>
	<<set $slaves to $slaves.sort(function(a, b){return a.actualAge-b.actualAge})>>
	<<else>>
	<<set $slaves to $slaves.sort(function(a, b){return b.actualAge-a.actualAge})>>
	<</if>>
<<default>>
	<<if ($sortSlavesOrder is "ascending")>>
	<<set $slaves to $slaves.sort(function(a, b){return a.devotion-b.devotion})>>
	<<else>>
	<<set $slaves to $slaves.sort(function(a, b){return b.devotion-a.devotion})>>
	<</if>>
<</switch>>

<<set $dormitoryPopulation to 0>>
<<set $roomsPopulation to 0>>
<<set $slavesVisible to 0>>
<<set _PA to -1>>
<<set _HG to -1>>
<<set _RC to -1>>
<<set _BG to -1>>

<<for $i to 0; $i < $slaves.length; $i++>>
	<<if $slaves[$i].assignmentVisible == 1>>
		<<set $slavesVisible++>>
		<<if $slaves[$i].livingRules is "luxurious">>
			<<if $slaves[$i].relationship >= 4>>
			  <<set $roomsPopulation += 0.5>>
			<<else>>
			  <<set $roomsPopulation++>>
			<</if>>
		<<else>>
			<<set $dormitoryPopulation++>>
		<</if>>
	<</if>>
	<<if $personalAttention == $slaves[$i].ID>>
		<<set _PA to $i>>
	<</if>>
	<<if $HeadGirl.ID == $slaves[$i].ID>>
		<<set _HG to $i>>
		<<continue>>
	<<elseif $Recruiter.ID == $slaves[$i].ID>>
		<<set _RC to $i>>
		<<continue>>
	<<elseif $Bodyguard.ID == $slaves[$i].ID>>
		<<set _BG to $i>>
		<<continue>>
	<</if>>
<</for>>

<<set $nextButton to "END WEEK">>
<<set $nextLink to "End Week">>
<<set $showEncyclopedia to 1>><<set $encyclopedia to "How to Play">>
<<display "Costs">>

<<if ($arcologies[0].name is "")>>
	<<set $arcologies[0].name to "Arcology X-4">>
<</if>>
<<if ($PC.customTitle is "")>>
	<<set $PC.customTitle to undefined>>
	<<set $PC.customTitleLisp to undefined>>
<</if>>
<<if ($brothelName is "")>>
	<<set $brothelName to "the Brothel">>
<</if>>
<<if ($brothelNameCaps is "")>>
	<<set $brothelNameCaps to "The Brothel">>
<</if>>
<<if ($dairyName is "")>>
	<<set $dairyName = "the Dairy">>
<</if>>
<<if ($dairyNameCaps is "")>>
	<<set $dairyNameCaps = "The Dairy">>
<</if>>
<<if ($clubName is "")>>
	<<set $clubName = "the Club">>
<</if>>
<<if ($clubNameCaps is "")>>
	<<set $clubNameCaps = "The Club">>
<</if>>
<<if ($servantsQuartersName is "")>>
	<<set $servantsQuartersName = "the Servants' Quarters">>
<</if>>
<<if ($servantsQuartersNameCaps is "")>>
	<<set $servantsQuartersNameCaps = "The Servants' Quarters">>
<</if>>
<<if ($schoolroomName is "")>>
	<<set $schoolroomName = "the Schoolroom">>
<</if>>
<<if ($schoolroomNameCaps is "")>>
	<<set $schoolroomNameCaps = "The Schoolroom">>
<</if>>
<<if ($spaName is "")>>
	<<set $spaName = "the Spa">>
<</if>>
<<if ($spaNameCaps is "")>>
	<<set $spaNameCaps = "The Spa">>
<</if>>
<<if ($clinicName is "")>>
	<<set $clinicName = "the Clinic">>
<</if>>
<<if ($clinicNameCaps is "")>>
	<<set $clinicNameCaps = "The Clinic">>
<</if>>
<<if ($arcadeName is "")>>
	<<set $arcadeName = "the Arcade">>
<</if>>
<<if ($arcadeNameCaps is "")>>
	<<set $arcadeNameCaps = "The Arcade">>
<</if>>
<<if ($cellblockName is "")>>
	<<set $cellblockName = "the Cellblock">>
<</if>>
<<if ($cellblockNameCaps  is "")>>
	<<set $cellblockNameCaps = "The Cellblock">>
<</if>>
<<if ($masterSuiteName is "")>>
	<<set $masterSuiteName = "the Master Suite">>
<</if>>
<<if ($masterSuiteNameCaps is "")>>
	<<set $masterSuiteNameCaps = "The Master Suite">>
<</if>>
<<if ($HGSuiteName is "")>>
	<<set $HGSuiteName = "the Head Girl Suite">>
<</if>>
<<if ($HGSuiteNameCaps is "")>>
	<<set $HGSuiteNameCaps = "The Head Girl Suite">>
<</if>>
<<if ($pitName is "")>>
	<<set $pitName = "the Pit">>
<</if>>
<<if ($pitNameCaps is "")>>
	<<set $pitNameCaps = "The Pit">>
<</if>>

<<if $seeArcology == 1>>&nbsp;&nbsp;&nbsp;&nbsp;//<<display "Arcology Description">> | [[Hide|Main][$seeArcology to 0]]//<br><</if>>

<<if $seeDesk == 1>>
<<display "Office Description">>
//[[Hide|Main][$seeDesk to 0]]//
<</if>>
<<if $seeFCNN == 1>><center>FCNN: <<print $fcnn.random()>>//[[Hide|Main][$seeFCNN to 0]]//</center><</if>>
<<if ($seeDesk == 1) && ($seeFCNN == 0)>><br><</if>>

__''MAIN MENU''__&nbsp;&nbsp;&nbsp;&nbsp;//[[Summary Options]]
<<if $rulesAssistantMain != 0>>
| [[Rules Assistant Options|Rules Assistant]]
<<if $rulesAssistantAuto != 1>>
	| <<click "Apply Rules Assistant at week end">><<set $rulesAssistantAuto to 1>><<goto "Main">><</click>>
<<else>>
	| <<click "Stop applying Rules Assistant at week end">><<set $rulesAssistantAuto to 0>><<goto "Main">><</click>>
<</if>>
| <<click "Activate Rules Assistant">><<for $i to 0; $i < $slaves.length; $i++>><<if $slaves[$i].useRulesAssistant == 1>><<if $slaves[$i].assignmentVisible == 1>><<set $activeSlave to $slaves[$i]>><<display "Default Rules">><<set $slaves[$i] to $activeSlave>><</if>><</if>><</for>><<goto "Main">><</click>>
<</if>>
<<if $sortSlavesMain != 0>>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;Sort by:
	<<if $sortSlavesBy != "devotion">>[[Devotion|Main][$sortSlavesBy to "devotion"]]<<else>>Devotion<</if>> |
	<<if $sortSlavesBy != "name">>[[Name|Main][$sortSlavesBy to "name"]]<<else>>Name<</if>> |
	<<if $sortSlavesBy != "assignment">>[[Assignment|Main][$sortSlavesBy to "assignment"]]<<else>>Assignment<</if>> |
	<<if $sortSlavesBy != "seniority">>[[Seniority purchased|Main][$sortSlavesBy to "seniority"]]<<else>>Seniority<</if>> |
	<<if $sortSlavesBy != "age">>[[Age|Main][$sortSlavesBy to "age"]]<<else>>Age<</if>> |
	Sort: <<if $sortSlavesOrder != "descending">>[[Descending|Main][$sortSlavesOrder to "descending"]]<<else>>Descending<</if>> |
	<<if $sortSlavesOrder != "ascending">>[[Ascending|Main][$sortSlavesOrder to "ascending"]]<<else>>Ascending<</if>>
<</if>>//
<<if $positionMainLinks >= 0>>
	<<MainLinks>>
<</if>>

<<display "Slave Summary">>

<<if $lineSeparations == 0>><br><<else>><hr style="margin:0"><</if>>
<<if $positionMainLinks <= 0>>
	<<MainLinks>>
<</if>>

<<set $j to "Back",$k to "AS Dump",$l to "Main">>
<<for $i to 0; $i < $slaves.length; $i++>>
<<if ($slaves[$i].assignment is "please you")>>
	<br><<display "Toychest">> //In the coming week you plan to concentrate on <<if $slaves[$i].fuckdoll == 0>>her<<else>>its<</if>> $slaves[$i].toyHole, but for now://
	<<if $slaves[$i].fuckdoll == 0>>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<<print "[[Use her mouth|FLips][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">> | <<print "[[Play with her tits|FBoobs][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	<<if canDoVaginal($slaves[$i])>>
		| <<print "[[Fuck her|FVagina][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
		<<if canDoAnal($slaves[$i])>>
		| <<print "[[Use her holes|FButt][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
		<</if>>
	<</if>>
	<<if canDoAnal($slaves[$i])>>
	| <<print "[[Fuck her ass|FAnus][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	<</if>>
	/*check*/
	<<if canAchieveErection($slaves[$i])>>
	| <<print "[[Ride her|FDick][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>	
	<</if>>
	| <<print "[[Abuse her|FAbuse][$activeSlave to $slaves[" + $i + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	<<else>>
		<span id="miniscene"></span>
		<<click "Fuck its face hole">><<replace "#miniscene">><<set $activeSlave = $slaves[i]>><<FFuckdollOral>><br><</replace>><</click>>
		<<if canDoVaginal($activeSlave)>>
			| <<click "Fuck its front hole">><<replace "#miniscene">><<set $activeSlave = $slaves[i]>><<FFuckdollVaginal>><br><</replace>><</click>>
<</if>>
		<<if canDoAnal($activeSlave)>>
			| <<click "Fuck its rear hole">><<replace "#miniscene">><<set $activeSlave = $slaves[i]>><<FFuckdollAnal>><br><</replace>><</click>>
		<</if>>
	<</if>>
<</if>>
<</for>>

<<set $j to "Back",$k to "AS Dump",$l to "Main">>
<<if (_BG > -1) && ($slaves[_BG].assignment is "guard you")>>
	<<set $i to _BG>>
	<<set $GO to "idiot ball">>
	<br><<display "Use Guard">>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<<print "[[Use her mouth|FLips][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	| <<print "[[Play with her tits|FBoobs][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	<<if canDoVaginal($slaves[_BG])>>
		| <<print "[[Fuck her|FVagina][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
		<<if canDoAnal($slaves[_BG])>>
		| <<print "[[Use her holes|FButt][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
		/*check*/
		<<if canAchieveErection($slaves[_BG])>>
		| <<print "[[Ride her|FDick][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
		<</if>>
		<</if>>
	<</if>>
	<<if canDoAnal($slaves[_BG])>>
	| <<print "[[Fuck her ass|FAnus][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
	<</if>>
	| <<print "[[Abuse her|FAbuse][$activeSlave to $slaves[" + _BG + "],$nextButton to $j,$nextLink to $k,$returnTo to $l]]">>
<</if>>

<<set $activeSlave to Array.random($slaves)>>
<<if ($activeSlave.assignment != "please you") && ($activeSlave.assignment != "guard you")>>
	<br><<display "Walk Past">>
<</if>>
